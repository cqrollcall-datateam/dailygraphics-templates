<% if (COPY.labels.headline) { %>
<h1><%= t.smarty(COPY.labels.headline) %></h1>
<% } %>

<% if (COPY.labels.subhed) { %>
<h2><%= t.smarty(COPY.labels.subhed) %></h2>
<% } %>

<div class="graphic" id="table-graphic">
  <table id="state-table">
    <thead>
      <tr>
        <th>
          <div class="sorter"><div class="icon"></div></div>
          <div class="header"><%= COPY.labels.hdr_state %></div>
        </th>
        <th>
          <div class="sorter"><div class="icon"></div></div>
          <div class="header"><%= COPY.labels.hdr_usps %></div>
        </th>
        <th>
          <div class="sorter"><div class="icon"></div></div>
          <div class="header"><%= COPY.labels.hdr_ap %></div>
        </th>
        <th class="amt">
          <div class="sorter"><div class="icon"></div></div>
          <div class="header"><%= COPY.labels.hdr_value %></div>
        </th>
      </tr>
    </thead>

    <% COPY.data.forEach(function(row) { %>
    <tr class="state-<%= t.classify(row.usps) %>">
      <td data-title="<%= COPY.labels.hdr_state %>"><%= row.name %></td>
      <td data-title="<%= COPY.labels.hdr_usps %>"><%= row.usps %></td>
      <td data-title="<%= COPY.labels.hdr_ap %>"><%= t.ap_state(row.usps) %></td>
      <td data-title="<%= COPY.labels.hdr_value %>" class="amt"><%= t.comma(row.value) %></td>
    </tr>
    <% }) %>

  </table>
</div>

<% if (COPY.labels.footnote) { %>
<div class="footnotes">
  <h4>Notes</h4>
  <p><%= COPY.labels.footnote %></p>
</div>
<% } %>

<div class="footer">
  <% if (COPY.labels.source) { %>
  <p>Source: <%= COPY.labels.source %></p>
  <% } %>
  
  <% if (COPY.labels.credit) { %>
  <p>Credit: <%= COPY.labels.credit %></p>
  <% } %>
</div>

<button value="export chart as svg" onclick="exportSvg()" class="export-svg-button">Export SVG</button>

<script type="text/javascript">
  //Function triggered on clicking "Export SVG" button to download SVG file of the chart.
    function exportSvg(){
      var svgItself = jQuery(".graphic-wrapper svg");
      var svgData = svgItself[0].outerHTML;
      var svgBlob = new Blob([svgData], {type:"image/svg+xml;charset=utf-8"});
      var svgUrl = URL.createObjectURL(svgBlob);
      var downloadLink = document.createElement("a");
      downloadLink.href = svgUrl;
      downloadLink.download = "chart.svg";
      document.body.appendChild(downloadLink);
      downloadLink.click();
      document.body.removeChild(downloadLink);
    };
</script>